# MediaAI Tools - æ¶æ„è®¾è®¡æ–‡æ¡£

## ğŸ“‹ ç›®å½•

- [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
- [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
- [æ ¸å¿ƒç»„ä»¶](#æ ¸å¿ƒç»„ä»¶)
- [æ•°æ®æµ](#æ•°æ®æµ)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [éƒ¨ç½²æ¶æ„](#éƒ¨ç½²æ¶æ„)

## ç³»ç»Ÿæ¦‚è¿°

MediaAI Tools æ˜¯ä¸€ä¸ªåŸºäº AI çš„æ™ºèƒ½è§†é¢‘å¤„ç†å¹³å°ï¼Œé‡‡ç”¨å¤šå±‚æ¶æ„è®¾è®¡ï¼Œæ”¯æŒè‡ªç„¶è¯­è¨€äº¤äº’ã€‚ç”¨æˆ·é€šè¿‡ Web ç•Œé¢æˆ– API ç”¨è‡ªç„¶è¯­è¨€æè¿°éœ€æ±‚ï¼Œç³»ç»Ÿè‡ªåŠ¨å®Œæˆè§†é¢‘å¤„ç†ä»»åŠ¡ã€‚

### æ ¸å¿ƒç‰¹æ€§

- **è‡ªç„¶è¯­è¨€ç†è§£** - åŸºäº LLM çš„æŒ‡ä»¤è§£æ
- **æ™ºèƒ½ä»»åŠ¡è·¯ç”±** - è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜æ‰§è¡Œç­–ç•¥
- **æ¨¡å—åŒ–è®¾è®¡** - Agent/Skills/Tools ä¸‰å±‚è§£è€¦
- **å¯æ‰©å±•æ€§** - æ’ä»¶å¼å·¥å…·å’ŒæŠ€èƒ½æ³¨å†Œ
- **é«˜æ€§èƒ½** - å¼‚æ­¥å¤„ç† + GPU åŠ é€Ÿ

## æ¶æ„è®¾è®¡

### æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ç”¨æˆ·ç•Œé¢å±‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Web UI         â”‚              â”‚  API Clients     â”‚      â”‚
â”‚  â”‚  (Browser)      â”‚              â”‚  (Python/cURL)   â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                                   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ HTTP/WebSocket
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     WebæœåŠ¡å±‚ (FastAPI)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  REST API    â”‚  â”‚  WebSocket   â”‚  â”‚ Static Files â”‚      â”‚
â”‚  â”‚  /api/*      â”‚  â”‚  /ws/*       â”‚  â”‚  /           â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â”‚                  â”‚                                 â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                   â”‚                                          â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚         â”‚  Task Manager     â”‚                               â”‚
â”‚         â”‚  (Background Jobs)â”‚                               â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Agentå±‚ (æ™ºèƒ½æ ¸å¿ƒ)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                   MediaAgent                          â”‚  â”‚
â”‚  â”‚                                                        â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚   Router     â”‚  â”‚    Memory    â”‚  â”‚  Evaluator â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ (è·¯ç”±é€‰æ‹©)    â”‚  â”‚   (ä¼šè¯è®°å¿†)  â”‚  â”‚ (è´¨é‡è¯„ä¼°) â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚         â”‚                  â”‚                  â”‚        â”‚  â”‚
â”‚  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Strategy Selection â”‚
                    â””â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
                        â”‚    â”‚    â”‚    â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                 â”‚    â”‚                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚  DIRECT_TOOL   â”‚  â”‚    WORKFLOW      â”‚  â”‚     SKILL      â”‚
â”‚  (å•å·¥å…·è°ƒç”¨)   â”‚  â”‚  (å¤šæ­¥éª¤å·¥ä½œæµ)   â”‚  â”‚  (ä¸šåŠ¡é€»è¾‘)     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                     â”‚                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚                      Skillså±‚ (ä¸šåŠ¡é€»è¾‘)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚SubtitleSkill â”‚  â”‚ BatchSkill   â”‚  â”‚ ImageSkill   â”‚     â”‚
â”‚  â”‚(å­—å¹•ç”Ÿæˆ)     â”‚  â”‚ (æ‰¹é‡å¤„ç†)    â”‚  â”‚ (å›¾ç‰‡å¤„ç†)    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                  â”‚                  â”‚             â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MCP Serverå±‚ (å·¥å…·æŠ½è±¡)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  SubtitleToolâ”‚  â”‚   ClipTool   â”‚  â”‚  FormatTool  â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚ OptimizeTool â”‚  â”‚  RotateTool  â”‚  â”‚  ResizeTool  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                  â”‚                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åº•å±‚å·¥å…·å±‚ (å¤–éƒ¨ä¾èµ–)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   FFmpeg     â”‚  â”‚   Whisper    â”‚  â”‚     YOLO     â”‚     â”‚
â”‚  â”‚  (è§†é¢‘å¤„ç†)   â”‚  â”‚  (è¯­éŸ³è¯†åˆ«)   â”‚  â”‚  (ç›®æ ‡æ£€æµ‹)   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚     PIL      â”‚  â”‚     LLM      â”‚  â”‚    CUDA      â”‚     â”‚
â”‚  â”‚  (å›¾ç‰‡å¤„ç†)   â”‚  â”‚  (æ–‡æœ¬çº é”™)   â”‚  â”‚  (GPUåŠ é€Ÿ)    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åˆ†å±‚è¯´æ˜

| å±‚çº§ | èŒè´£ | æŠ€æœ¯æ ˆ | ç¤ºä¾‹ |
|------|------|--------|------|
| **ç”¨æˆ·ç•Œé¢å±‚** | ç”¨æˆ·äº¤äº’ | HTML/CSS/JavaScript | Web UI, API Client |
| **WebæœåŠ¡å±‚** | HTTPæœåŠ¡ | FastAPI, Uvicorn | REST API, WebSocket |
| **Agentå±‚** | æ™ºèƒ½è·¯ç”±ä¸å†³ç­– | LangChain, LangGraph | Router, Memory, Evaluator |
| **Skillså±‚** | ä¸šåŠ¡é€»è¾‘ç¼–æ’ | Python Async | SubtitleSkill, BatchSkill |
| **MCP Serverå±‚** | å·¥å…·æ ‡å‡†åŒ–æ¥å£ | MCP Protocol | ClipTool, SubtitleTool |
| **åº•å±‚å·¥å…·å±‚** | å®é™…æ‰§è¡Œ | FFmpeg, Whisper, YOLO | è§†é¢‘è£å‰ª, è¯­éŸ³è¯†åˆ« |

## æ ¸å¿ƒç»„ä»¶

### 1. MediaAgent (æ™ºèƒ½æ ¸å¿ƒ)

**èŒè´£**: ç»Ÿä¸€å…¥å£ï¼Œè´Ÿè´£ä»»åŠ¡åˆ†æã€è·¯ç”±å†³ç­–ã€æ‰§è¡Œç›‘æ§å’Œç»“æœè¯„ä¼°ã€‚

**ä½ç½®**: `src/agent/media_agent.py`

**æ ¸å¿ƒèƒ½åŠ›**:
```python
class MediaAgent:
    def __init__(self):
        self.router = IntelligentRouter()       # è·¯ç”±å™¨
        self.memory = MemoryManager()           # è®°å¿†ç®¡ç†
        self.evaluator = Evaluator()            # è´¨é‡è¯„ä¼°
        self.mcp_server = MediaMCPServer()      # å·¥å…·æœåŠ¡å™¨
        self.skill_registry = SkillRegistry()   # æŠ€èƒ½æ³¨å†Œè¡¨
    
    async def process(self, instruction: str) -> Dict:
        """ä¸»å¤„ç†æµç¨‹"""
        # 1. è·¯ç”±å†³ç­–
        strategy = self.router.route(instruction)
        
        # 2. æ‰§è¡Œç­–ç•¥
        if strategy == "DIRECT_TOOL":
            result = self._execute_tool(instruction)
        elif strategy == "WORKFLOW":
            result = await self._execute_workflow(instruction)
        elif strategy == "SKILL":
            result = await self._execute_skill(instruction)
        
        # 3. è´¨é‡è¯„ä¼°
        score = self.evaluator.evaluate(result)
        
        # 4. è®°å½•å†å²
        self.memory.add(instruction, result, score)
        
        return result
```

### 2. IntelligentRouter (æ™ºèƒ½è·¯ç”±å™¨)

**èŒè´£**: åˆ†æç”¨æˆ·æŒ‡ä»¤ï¼Œé€‰æ‹©æœ€ä¼˜æ‰§è¡Œç­–ç•¥ã€‚

**ä½ç½®**: `src/agent/router.py`

**è·¯ç”±ç­–ç•¥**:

| ç­–ç•¥ | é€‚ç”¨åœºæ™¯ | ç¤ºä¾‹æŒ‡ä»¤ |
|------|---------|---------|
| **DIRECT_TOOL** | å•ä¸€æ˜ç¡®æ“ä½œ | "è£å‰ªè§†é¢‘ 0-30ç§’" |
| **WORKFLOW** | å¤æ‚å¤šæ­¥ä»»åŠ¡ | "æå–éŸ³é¢‘å¹¶è½¬æ–‡å­—ç”Ÿæˆå­—å¹•" |
| **SKILL** | ä¸šåŠ¡é€»è¾‘æ“ä½œ | "æ‰¹é‡æ·»åŠ å­—å¹•" |
| **AGENT** | éœ€è¦LLMåˆ†æ | "å¸®æˆ‘å¤„ç†è¿™ä¸ªè§†é¢‘è®©å®ƒæ›´æ¸…æ™°" |

**å…³é”®ä»£ç **:
```python
class IntelligentRouter:
    def route(self, instruction: str) -> str:
        # å…³é”®è¯åŒ¹é…
        if self._match_keywords(instruction, self.keyword_patterns['SUBTITLE']):
            return 'SKILL'  # å­—å¹•ä»»åŠ¡ â†’ SubtitleSkill
        
        # å¤æ‚åº¦åˆ†æ
        if self._is_complex_task(instruction):
            return 'WORKFLOW'
        
        # å•å·¥å…·æ£€æµ‹
        if self._is_single_tool(instruction):
            return 'DIRECT_TOOL'
        
        # é»˜è®¤ä½¿ç”¨Agentåˆ†æ
        return 'AGENT'
```

### 3. MemoryManager (è®°å¿†ç®¡ç†)

**èŒè´£**: ç»´æŠ¤ä¼šè¯å†å²ï¼Œæ”¯æŒä¸Šä¸‹æ–‡ç†è§£ã€‚

**ä½ç½®**: `src/agent/memory.py`

**åŠŸèƒ½**:
- çŸ­æœŸè®°å¿†ï¼šæœ€è¿‘10æ¡å¯¹è¯
- é•¿æœŸè®°å¿†ï¼šä»»åŠ¡ç»Ÿè®¡ã€ç”¨æˆ·åå¥½
- æŒä¹…åŒ–ï¼šä¿å­˜åˆ°æœ¬åœ°JSONæ–‡ä»¶

**æ¥å£**:
```python
class MemoryManager:
    def add(self, instruction: str, result: Dict, score: float):
        """æ·»åŠ è®°å¿†"""
    
    def get_recent(self, n: int = 5) -> List[Dict]:
        """è·å–æœ€è¿‘Næ¡è®°å¿†"""
    
    def search(self, query: str) -> List[Dict]:
        """è¯­ä¹‰æœç´¢å†å²è®°å½•"""
```

### 4. Evaluator (è´¨é‡è¯„ä¼°å™¨)

**èŒè´£**: è¯„ä¼°ä»»åŠ¡æ‰§è¡Œè´¨é‡ï¼Œç”Ÿæˆåˆ†æ•°å’Œæ”¹è¿›å»ºè®®ã€‚

**ä½ç½®**: `src/agent/evaluator.py`

**è¯„ä¼°ç»´åº¦**:

| ç»´åº¦ | æƒé‡ | æ£€æŸ¥å†…å®¹ | åˆ†æ•°èŒƒå›´ |
|------|------|---------|---------|
| **æ–‡ä»¶å­˜åœ¨æ€§** | 20% | è¾“å‡ºæ–‡ä»¶æ˜¯å¦ç”Ÿæˆ | 0-20 |
| **å­—å¹•è´¨é‡** | 30% | æ—¶é—´è½´ã€è¡Œæ•°ã€æ ¼å¼ | 0-30 |
| **æ‰§è¡Œæ•ˆç‡** | 20% | è€—æ—¶æ˜¯å¦åˆç† | 0-20 |
| **çº é”™è´¨é‡** | 30% | LLMçº æ­£æ•°é‡ | 0-30 |

**è´¨é‡ç­‰çº§**:
```python
EXCELLENT  = 90-100  # ä¼˜ç§€
GOOD       = 70-89   # è‰¯å¥½
ACCEPTABLE = 50-69   # åˆæ ¼
POOR       = 30-49   # è¾ƒå·®
FAILED     = 0-29    # å¤±è´¥
```

### 5. Skills (æŠ€èƒ½å±‚)

**èŒè´£**: å°è£…ä¸šåŠ¡é€»è¾‘ï¼Œå¯å¤ç”¨çš„é«˜çº§åŠŸèƒ½ã€‚

**ä½ç½®**: `src/skills/`

#### SubtitleSkill (å­—å¹•ç”ŸæˆæŠ€èƒ½)

```python
class SubtitleSkill(BaseSkill):
    async def execute(self, instruction: str, **kwargs):
        # 1. æå–ä¸“ä¸šæœ¯è¯­ï¼ˆLLMï¼‰
        terms = await self._extract_professional_terms(instruction)
        
        # 2. è°ƒç”¨å­—å¹•ç”Ÿæˆå·¥å…·
        result = self.mcp_server.execute_tool(
            "subtitle",
            input_file=file_path,
            language="zh",
            professional_terms=terms,
            use_llm_correction=True
        )
        
        # 3. è¿”å›ç»“æœ
        return result
```

#### BatchSkill (æ‰¹é‡å¤„ç†æŠ€èƒ½)

```python
class BatchSkill(BaseSkill):
    async def execute(self, instruction: str, **kwargs):
        # 1. LLMè§£æå‚æ•°
        params = await self._llm_extract_params(instruction)
        
        # 2. æ™ºèƒ½æ–‡ä»¶/ç›®å½•æ£€æµ‹
        if os.path.isfile(params['path']):
            files = [params['path']]
        else:
            files = self._scan_directory(params['path'])
        
        # 3. æ‰¹é‡æ‰§è¡Œ
        results = []
        for file in files:
            result = await self._process_single(file, params)
            results.append(result)
        
        # 4. èšåˆè¯„ä¼°
        return self._aggregate_results(results)
```

### 6. MCP Server (å·¥å…·æœåŠ¡å™¨)

**èŒè´£**: ç»Ÿä¸€å·¥å…·è°ƒç”¨æ¥å£ï¼Œæ ‡å‡†åŒ–è¾“å…¥è¾“å‡ºã€‚

**ä½ç½®**: `src/mcp_server/server.py`

**å·¥å…·åˆ—è¡¨**:

| å·¥å…·å | åŠŸèƒ½ | è¾“å…¥ | è¾“å‡º |
|--------|------|------|------|
| `subtitle` | ç”Ÿæˆå­—å¹• | è§†é¢‘è·¯å¾„ | SRTæ–‡ä»¶ |
| `clip` | è£å‰ªè§†é¢‘ | è·¯å¾„+æ—¶é—´èŒƒå›´ | è§†é¢‘æ–‡ä»¶ |
| `convert` | æ ¼å¼è½¬æ¢ | è·¯å¾„+ç›®æ ‡æ ¼å¼ | è§†é¢‘æ–‡ä»¶ |
| `optimize` | è§†é¢‘ä¼˜åŒ– | è·¯å¾„+å‚æ•° | è§†é¢‘æ–‡ä»¶ |
| `rotate` | æ™ºèƒ½æ—‹è½¬ | å›¾ç‰‡è·¯å¾„ | å›¾ç‰‡æ–‡ä»¶ |
| `resize` | è°ƒæ•´å°ºå¯¸ | è·¯å¾„+å°ºå¯¸ | å›¾ç‰‡æ–‡ä»¶ |

**è°ƒç”¨ç¤ºä¾‹**:
```python
mcp_server = MediaMCPServer()

result = mcp_server.execute_tool(
    tool_name="subtitle",
    input_file="video.mp4",
    language="zh",
    use_llm_correction=True
)
```

### 7. Tools (å·¥å…·å±‚)

**èŒè´£**: å°è£…åº•å±‚å‘½ä»¤ï¼Œæä¾›ç»Ÿä¸€æ¥å£ã€‚

**ä½ç½®**: `src/mcp_server/tools.py`

#### SubtitleTool (å­—å¹•å·¥å…·)

**æ ¸å¿ƒæµç¨‹**:
```
è§†é¢‘æ–‡ä»¶
    â†“
1. FFmpeg æå–éŸ³é¢‘ (audio.wav)
    â†“
2. Whisper è¯­éŸ³è¯†åˆ« (raw_subtitles.srt)
    â†“
3. åˆ†æ‰¹æ¬¡å¤„ç†
    â†“
4. LLM æ™ºèƒ½çº é”™ (for each batch)
    â”œâ”€ åŒéŸ³å­—çº æ­£
    â”œâ”€ è¯­ä¹‰é”™è¯¯ä¿®å¤
    â”œâ”€ ä¸“ä¸šæœ¯è¯­ä¿ç•™
    â””â”€ æ•°å­—/è‹±æ–‡è¿˜åŸ
    â†“
5. åˆå¹¶æ‰¹æ¬¡
    â†“
6. ç”Ÿæˆæœ€ç»ˆå­—å¹• (final_subtitles.srt)
```

**LLMçº é”™ç­–ç•¥**:
- **æ‰¹é‡å¤§å°**: 15æ¡/æ‰¹ (é¿å…ä¸Šä¸‹æ–‡çª—å£æº¢å‡º)
- **é™çº§ç­–ç•¥**: æ‰¹æ¬¡å¤±è´¥ â†’ ä¿ç•™WhisperåŸæ–‡
- **çº æ­£ç»Ÿè®¡**: è¿”å› `correction_count` ä¾›Evaluatorè¯„åˆ†

## æ•°æ®æµ

### å­—å¹•ç”Ÿæˆå®Œæ•´æµç¨‹

```
ç”¨æˆ·è¾“å…¥: "å¸®æˆ‘ç»™D:\video\demo.mp4æ·»åŠ å­—å¹•"
    â”‚
    â†“
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Web UI â†’ FastAPI                                        â”‚
â”‚    POST /api/agent/process                                 â”‚
â”‚    { "instruction": "...", "use_llm_correction": true }   â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â†“
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. MediaAgent.process()                                    â”‚
â”‚    - åˆ›å»ºä»»åŠ¡ID                                             â”‚
â”‚    - å¯åŠ¨åå°ä»»åŠ¡                                           â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â†“
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. IntelligentRouter.route()                               â”‚
â”‚    - å…³é”®è¯åŒ¹é…: "æ·»åŠ å­—å¹•" â†’ SKILL                         â”‚
â”‚    - è¿”å›: "SKILL"                                         â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â†“
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. BatchSkill.execute()                                    â”‚
â”‚    - LLMè§£æ: { operation: "subtitle", path: "demo.mp4" } â”‚
â”‚    - æ–‡ä»¶æ£€æµ‹: å•æ–‡ä»¶ â†’ åŒ…è£…ä¸ºåˆ—è¡¨                          â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â†“
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. SubtitleSkill.execute() (for each file)                â”‚
â”‚    - æå–ä¸“ä¸šæœ¯è¯­ (LLMå¯é€‰)                                 â”‚
â”‚    - è°ƒç”¨MCP Server                                        â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â†“
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. MediaMCPServer.execute_tool("subtitle", ...)           â”‚
â”‚    - æŸ¥æ‰¾å·¥å…·: available_tools["subtitle"]                 â”‚
â”‚    - æ‰§è¡Œå·¥å…·                                              â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â†“
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. SubtitleTool.execute()                                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚    â”‚ a. FFmpeg æå–éŸ³é¢‘                     â”‚              â”‚
â”‚    â”‚    ffmpeg -i demo.mp4 audio.wav       â”‚              â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚    â”‚ b. Whisper è¯­éŸ³è¯†åˆ«                    â”‚              â”‚
â”‚    â”‚    whisper audio.wav --model medium   â”‚              â”‚
â”‚    â”‚    â†’ raw_subtitles.srt (100è¡Œ)        â”‚              â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚    â”‚ c. åˆ†æ‰¹å¤„ç† (æ¯æ‰¹15è¡Œ)                 â”‚              â”‚
â”‚    â”‚    Batch 1: lines 1-15                â”‚              â”‚
â”‚    â”‚    Batch 2: lines 16-30               â”‚              â”‚
â”‚    â”‚    ...                                â”‚              â”‚
â”‚    â”‚    Batch 7: lines 91-100              â”‚              â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚    â”‚ d. LLMçº é”™ (æ¯æ‰¹ç‹¬ç«‹)                  â”‚              â”‚
â”‚    â”‚    - DeepSeek/OpenAI/Qwen2            â”‚              â”‚
â”‚    â”‚    - åŒéŸ³å­—: "æ¬ å¥—" â†’ "åµŒå¥—"          â”‚              â”‚
â”‚    â”‚    - è¯­ä¹‰: "å‡½æ ‘" â†’ "å‡½æ•°"            â”‚              â”‚
â”‚    â”‚    - ä¿ç•™: "Python", "GPU", "3.14"    â”‚              â”‚
â”‚    â”‚    â†’ corrected_batch (JSON)           â”‚              â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚    â”‚ e. é™çº§å¤„ç†                            â”‚              â”‚
â”‚    â”‚    - æ‰¹æ¬¡å¤±è´¥? ä¿ç•™WhisperåŸæ–‡         â”‚              â”‚
â”‚    â”‚    - æ‰¹æ¬¡æˆåŠŸ? ä½¿ç”¨LLMçº æ­£             â”‚              â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚    â”‚ f. åˆå¹¶æ‰¹æ¬¡                            â”‚              â”‚
â”‚    â”‚    corrected_batch1 + batch2 + ...    â”‚              â”‚
â”‚    â”‚    â†’ final_subtitles.srt              â”‚              â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â†“
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. Evaluator.evaluate()                                    â”‚
â”‚    - æ–‡ä»¶å­˜åœ¨? âœ… +20åˆ†                                     â”‚
â”‚    - å­—å¹•è´¨é‡: 100è¡Œ, æ ¼å¼æ­£ç¡® âœ… +30åˆ†                     â”‚
â”‚    - æ‰§è¡Œæ—¶é—´: 180ç§’ (åˆç†) âœ… +20åˆ†                        â”‚
â”‚    - çº é”™è´¨é‡: 25æ¬¡çº æ­£ âœ… +30åˆ†                            â”‚
â”‚    â†’ æ€»åˆ†: 100/100 (EXCELLENT)                             â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â†“
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 9. MemoryManager.add()                                     â”‚
â”‚    - ä¿å­˜å¯¹è¯å†å²                                          â”‚
â”‚    - æ›´æ–°ä»»åŠ¡ç»Ÿè®¡                                          â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â†“
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 10. è¿”å›ç»“æœç»™ FastAPI                                     â”‚
â”‚     {                                                      â”‚
â”‚       "success": true,                                     â”‚
â”‚       "message": "å­—å¹•ç”ŸæˆæˆåŠŸ",                            â”‚
â”‚       "output_file": "demo_subtitles.srt",                 â”‚
â”‚       "evaluation": {                                      â”‚
â”‚         "score": 100,                                      â”‚
â”‚         "level": "EXCELLENT",                              â”‚
â”‚         "correction_count": 25                             â”‚
â”‚       }                                                    â”‚
â”‚     }                                                      â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â†“
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 11. Web UI æ˜¾ç¤ºç»“æœ                                        â”‚
â”‚     âœ… ä»»åŠ¡å®Œæˆ (100/100 åˆ†)                               â”‚
â”‚     ğŸ“„ è¾“å‡ºæ–‡ä»¶: demo_subtitles.srt                        â”‚
â”‚     ğŸ”§ LLMçº æ­£: 25å¤„                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æŠ€æœ¯æ ˆ

### åç«¯æŠ€æœ¯

| ç±»åˆ« | æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|------|
| **Webæ¡†æ¶** | FastAPI | 2.0+ | RESTful APIæœåŠ¡ |
| **ASGIæœåŠ¡å™¨** | Uvicorn | 0.27+ | å¼‚æ­¥HTTPæœåŠ¡å™¨ |
| **LLMæ¡†æ¶** | LangChain | 0.1+ | LLMåº”ç”¨å¼€å‘ |
| **å·¥ä½œæµ** | LangGraph | 0.0+ | å¤æ‚ä»»åŠ¡ç¼–æ’ |
| **è¯­éŸ³è¯†åˆ«** | OpenAI Whisper | - | è§†é¢‘è½¬æ–‡å­— |
| **è§†é¢‘å¤„ç†** | FFmpeg | 6.0+ | éŸ³è§†é¢‘å¤„ç† |
| **ç›®æ ‡æ£€æµ‹** | Ultralytics YOLO | 8.0+ | å›¾ç‰‡æ™ºèƒ½æ—‹è½¬ |
| **å›¾ç‰‡å¤„ç†** | Pillow | 10.0+ | å›¾ç‰‡æ“ä½œ |

### å‰ç«¯æŠ€æœ¯

| ç±»åˆ« | æŠ€æœ¯ | è¯´æ˜ |
|------|------|------|
| **UIæ¡†æ¶** | åŸç”ŸHTML/CSS/JS | æ— æ„å»ºæ­¥éª¤ |
| **æ ·å¼** | ç°ä»£CSS3 | Flexbox, Grid |
| **äº¤äº’** | Fetch API | å¼‚æ­¥HTTPè¯·æ±‚ |
| **è½®è¯¢** | setInterval | ä»»åŠ¡çŠ¶æ€æŸ¥è¯¢ |

### AIæ¨¡å‹

| æ¨¡å‹ | ç±»å‹ | ç”¨é€” | éƒ¨ç½²æ–¹å¼ |
|------|------|------|---------|
| **Qwen2-1.5B** | æœ¬åœ°LLM | å­—å¹•çº é”™ | Transformers |
| **Whisper-Medium** | è¯­éŸ³è¯†åˆ« | éŸ³é¢‘è½¬æ–‡å­— | OpenAI Whisper |
| **YOLOv8** | ç›®æ ‡æ£€æµ‹ | äººç‰©æ£€æµ‹æ—‹è½¬ | Ultralytics |
| **DeepSeek** | äº‘ç«¯LLM | é«˜è´¨é‡çº é”™ | APIè°ƒç”¨ |
| **OpenAI GPT** | äº‘ç«¯LLM | é«˜è´¨é‡çº é”™ | APIè°ƒç”¨ |

## éƒ¨ç½²æ¶æ„

### Docker å•å®¹å™¨éƒ¨ç½²

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Docker Container (mediaai)          â”‚
â”‚                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚       FastAPI Application               â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  Web Server  â”‚  â”‚  Agent Engine   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  (Uvicorn)   â”‚  â”‚  (MediaAgent)   â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                              â”‚
â”‚  Volumes:                                    â”‚
â”‚  â”œâ”€ /app/uploads  â† ./uploads               â”‚
â”‚  â”œâ”€ /app/output   â† ./output                â”‚
â”‚  â”œâ”€ /app/logs     â† ./logs                  â”‚
â”‚  â””â”€ /root/.cache  â† model-cache             â”‚
â”‚                                              â”‚
â”‚  Ports:                                      â”‚
â”‚  â””â”€ 8000:8000                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¯åŠ¨å‘½ä»¤**:
```bash
docker-compose up -d
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½² (Nginx + Docker)

```
Internet
    â”‚
    â†“
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             Nginx Reverse Proxy              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  SSL Termination (HTTPS)               â”‚  â”‚
â”‚  â”‚  Static File Serving (/web/*)          â”‚  â”‚
â”‚  â”‚  API Proxying (/api/* â†’ :8000)         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ :80/:443
    â†“
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Docker Container (mediaai)           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚      FastAPI Backend (:8000)           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Nginx é…ç½®ç¤ºä¾‹**:
```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    # Web UI
    location / {
        root /var/www/mediaai/web;
        index index.html;
    }
    
    # API
    location /api/ {
        proxy_pass http://localhost:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

## æ€§èƒ½ä¼˜åŒ–

### 1. å¼‚æ­¥å¤„ç†

æ‰€æœ‰è€—æ—¶æ“ä½œä½¿ç”¨å¼‚æ­¥:
```python
# Skills å’Œ Agent å¿…é¡»ç”¨ async
async def execute(self, instruction: str):
    result = await self.some_long_operation()
```

### 2. GPU åŠ é€Ÿ

æ”¯æŒ CUDA åŠ é€Ÿ:
```yaml
# docker-compose.yml
deploy:
  resources:
    reservations:
      devices:
        - driver: nvidia
          count: 1
          capabilities: [gpu]
```

### 3. æ¨¡å‹ç¼“å­˜

Hugging Face æ¨¡å‹ç¼“å­˜åˆ° Docker volume:
```yaml
volumes:
  - model-cache:/root/.cache/huggingface
```

### 4. æ‰¹å¤„ç†ä¼˜åŒ–

LLM çº é”™æ‰¹é‡å¤§å°å¹³è¡¡:
- **å¤ªå°** (5è¡Œ): APIè°ƒç”¨é¢‘ç¹ï¼Œæ…¢
- **å¤ªå¤§** (50è¡Œ): ä¸Šä¸‹æ–‡çª—å£æº¢å‡º
- **æœ€ä¼˜** (15è¡Œ): æ€§èƒ½å’Œå‡†ç¡®ç‡å¹³è¡¡

## æ‰©å±•æ€§

### æ·»åŠ æ–°å·¥å…·

1. ç»§æ‰¿ `MediaTool` åŸºç±»
2. å®ç° `execute()` æ–¹æ³•
3. æ³¨å†Œåˆ° `MediaMCPServer`

### æ·»åŠ æ–°æŠ€èƒ½

1. ç»§æ‰¿ `BaseSkill` åŸºç±»
2. å®ç° `async execute()` æ–¹æ³•
3. æ³¨å†Œåˆ° `SkillRegistry`
4. æ›´æ–°è·¯ç”±å…³é”®è¯

### æ·»åŠ æ–° LLM

1. ç»§æ‰¿ `BaseLLMProvider`
2. å®ç° `get_llm()` å’Œ `is_available()`
3. åœ¨ `LLMManager` ä¸­æ³¨å†Œ
4. æ·»åŠ é…ç½®èŠ‚

## ç›‘æ§ä¸æ—¥å¿—

### æ—¥å¿—ç³»ç»Ÿ

ç»Ÿä¸€ä½¿ç”¨ `utils/logger.py`:
```python
from utils.logger import get_logger
logger = get_logger(__name__)

logger.info("æ“ä½œå¼€å§‹")
logger.error("é”™è¯¯", exc_info=True)
```

**æ—¥å¿—çº§åˆ«**: DEBUG (å¼€å‘), INFO (ç”Ÿäº§)

### æ—¥å¿—ä½ç½®

```
logs/
â”œâ”€â”€ benchmarks/       # æ€§èƒ½åŸºå‡†
â”œâ”€â”€ evaluations/      # è´¨é‡è¯„ä¼°
â””â”€â”€ memory/           # ä¼šè¯å†å²
```

### æ€§èƒ½ç›‘æ§

é€šè¿‡ Evaluator è¿½è¸ª:
- ä»»åŠ¡æ‰§è¡Œæ—¶é—´
- æˆåŠŸ/å¤±è´¥ç‡
- è´¨é‡åˆ†æ•°åˆ†å¸ƒ
- LLMè°ƒç”¨æ¬¡æ•°

## å®‰å…¨æ€§

### API å®‰å…¨

- **è¾“å…¥éªŒè¯**: Pydantic æ¨¡å‹éªŒè¯
- **è·¯å¾„å®‰å…¨**: é˜²æ­¢ç›®å½•éå†
- **æ–‡ä»¶ç±»å‹**: ç™½åå•éªŒè¯

### æ•°æ®å®‰å…¨

- **æœ¬åœ°å¤„ç†**: æ•°æ®ä¸ç¦»å¼€æœåŠ¡å™¨
- **ä¸´æ—¶æ–‡ä»¶**: å¤„ç†åè‡ªåŠ¨æ¸…ç†
- **è®¿é—®æ§åˆ¶**: (ç”Ÿäº§ç¯å¢ƒæ·»åŠ è®¤è¯)

## æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|---------|
| å­—å¹•ç”Ÿæˆå¤±è´¥ | FFmpegæœªå®‰è£… | `apt install ffmpeg` |
| LLMçº é”™å¤±è´¥ | API Keyé”™è¯¯ | æ£€æŸ¥ `config.yaml` |
| GPUä¸å¯ç”¨ | CUDAæœªå®‰è£… | å®‰è£…CUDAæˆ–ä½¿ç”¨CPUæ¨¡å¼ |
| å†…å­˜æº¢å‡º | è§†é¢‘æ–‡ä»¶è¿‡å¤§ | å¢åŠ Dockerå†…å­˜é™åˆ¶ |

### æ—¥å¿—æŸ¥çœ‹

```bash
# å®æ—¶æ—¥å¿—
docker-compose logs -f

# ç‰¹å®šæœåŠ¡
docker-compose logs -f mediaai

# æœ€è¿‘100è¡Œ
docker-compose logs --tail=100
```

## ç‰ˆæœ¬å†å²

- **v1.0.0** (2024-01) - åˆå§‹å‘å¸ƒ
- **v1.1.0** (2024-02) - æ·»åŠ æ‰¹é‡å¤„ç†
- **v1.2.0** (2024-03) - LLMæ™ºèƒ½çº é”™
- **v1.3.0** (2024-04) - Web UIé‡æ„
- **v2.0.0** (2024-05) - å®Œæ•´DockeråŒ–

---

**æ–‡æ¡£ç»´æŠ¤**: è¯·åœ¨ä¿®æ”¹æ¶æ„æ—¶åŒæ­¥æ›´æ–°æœ¬æ–‡æ¡£ã€‚
